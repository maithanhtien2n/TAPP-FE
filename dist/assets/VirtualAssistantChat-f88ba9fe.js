import{c as q,o as s,d as o,e as t,x as B,H as f,K as R,u as $,a0 as j,B as p,q as M,D as A,E as H,C as d,f as U,F as w,I as D,g as h,s as b,a2 as k,t as E,a3 as I,w as K,N as L,z}from"./index-cd90e316.js";import{_ as F}from"./ButtonBack-0da8da28.js";const O={class:"flex gap-2"},G=["src"],W={class:"flex flex-column gap-1 w-full"},J={class:"font-bold text-800"},P=["innerHTML"],N={__name:"UserChat",props:{image:{type:String,required:!1,default:""},name:{type:String,required:!1,default:""},message:{type:String,required:!1,default:""}},setup(r){return(_,u)=>{const a=q("Skeleton");return s(),o("div",O,[t("img",{class:"w-2rem h-2rem border-circle object-fit-cover box-shadow-1",src:r.image||"https://bloganchoi.com/wp-content/uploads/2022/02/avatar-trang-y-nghia.jpeg",alt:"Lỗi ảnh"},null,8,G),t("div",W,[t("span",J,B(r.name),1),r.message?(s(),o("div",{key:0,innerHTML:r.message,style:{"text-align":"justify","white-space":"pre-wrap"},class:"text-800 line-height-3"},null,8,P)):(s(),f(a,{key:1,class:"w-full mt-2",height:"4rem"}))])])}}},Q=t("br",null,null,-1),X=t("br",null,null,-1),Y={style:{"max-width":"40rem"},class:"flex flex-column gap-4 m-auto w-full h-full pb-6"},Z={key:1,class:"flex h-full justify-content-center align-items-center"},ee={class:"flex flex-column gap-3 align-items-center"},te=t("img",{class:"w-10rem h-10rem",src:"https://cdn-icons-png.flaticon.com/512/1698/1698535.png",alt:"Lỗi ảnh"},null,-1),se={class:"text-center line-height-2"},ae={class:"text-main-color"},ne={style:{bottom:"1.8rem"},class:"fixed z-5 left-0 right-0 px-3 bg-white"},le={style:{"max-width":"50rem"},class:"p-3 border-round-3xl box-shadow-1 flex bg-white m-auto flex-1"},oe=["onKeypress"],ie={style:{"padding-left":"0.7rem"},class:"border-left-1 text-400"},re={key:0,class:"pi pi-spin pi-spinner text-900"},me={__name:"VirtualAssistantChat",setup(r){const _=R(),u=$(),{onGetterMessages:a,onActionChat:T,onActionCheckLinkChat:S}=j(),c=p(""),i=p(!1),g=p(!1),v=M(()=>_.query.id),m=()=>{setTimeout(()=>{window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"})},1)},x=e=>{switch(e){case"user":return{image:"/images/avatar-you.png",name:"Bạn"};case"assistant":return{image:"/images/avatar-bot.jpg",name:"Bot"};default:return""}},C=()=>{if(!z.value){u.replace({name:"Home"});return}a.value=[],u.replace({name:"VirtualAssistant"})},y=async()=>{if(i.value)return;let e="";e=c.value,c.value="",a.value.push({role:"user",content:e}),m(),i.value=!0,T({userId:v.value,contents:a.value}).then(l=>{a.value.push(l.data),m(),i.value=!1}).catch(()=>{i.value=!1})};return A(i,e=>{e?setTimeout(()=>{g.value=!0,m()},600):g.value=!1}),H(async()=>{var l,n;const e=await S(v.value);if(e.success)d.value.fullName=((l=e==null?void 0:e.data)==null?void 0:l.fullName)||"",d.value.userName=((n=e==null?void 0:e.data)==null?void 0:n.userName)||"";else{u.replace({name:"NotFound"});return}m()}),(e,l)=>(s(),o(w,null,[U(F,{onOnClick:C}),Q,X,t("div",Y,[(s(!0),o(w,null,D(h(a),(n,V)=>(s(),f(N,{key:V,image:x(n.role).image,name:x(n.role).name,message:n.content},null,8,["image","name","message"]))),128)),g.value?(s(),f(N,{key:0,image:"/images/avatar-bot.jpg",name:"Bot"})):b("",!0),h(a).length?b("",!0):(s(),o("div",Z,[t("div",ee,[te,t("span",se,[k(" Chào bạn, tôi là chat bot do "),t("span",ae,B(h(d).fullName||h(d).userName),1),k(" tạo ra! ")])])]))]),t("div",ne,[t("div",le,[E(t("input",{"onUpdate:modelValue":l[0]||(l[0]=n=>c.value=n),type:"text",class:"w-full border-none outline-none",placeholder:"Bạn muốn hỏi gì?",onKeypress:K(y,["enter"])},null,40,oe),[[I,c.value]]),t("div",ie,[i.value?(s(),o("i",re)):(s(),o("i",{key:1,class:L(["pi pi-angle-right text-900 on-click",{"p-disabled":!c.value}]),onClick:y},null,2))])])])],64))}};export{me as default};
