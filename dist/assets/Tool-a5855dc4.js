import{c as O,a as R,_ as Q}from"./InputTextValidate-d77f4655.js";import{u as W,a as Y}from"./vee-validate.esm-7e106f6b.js";import{_ as I,m as w,n as Z,u as P,q as C,o as u,d as m,e as t,s as F,t as ee,v as te,x as U,g as k,y as oe,z as se,A as ne,r as ae,B as q,C as le,D as ie,E as ce,c as y,f as r,G as re,H as B,F as N,I as ue,J as de,p as pe,j as me}from"./index-cd90e316.js";import{_ as fe}from"./IconTitle-07653c90.js";import{_ as _e}from"./ImageValidate-96e56cb1.js";import{_ as ge}from"./DropdownValidate-9187754b.js";const ve={style:{width:"23.5%","margin-bottom":"2%",overflow:"hidden"},class:"relative card h-7rem"},he={key:0,style:{"background-color":"#4caf4f9c"},class:"action-bg absolute z-5 top-0 left-0 right-0 bottom-0 flex gap-2 justify-content-center align-items-center"},be={key:1,class:"h-full flex align-items-center justify-content-center gap-2"},xe={key:2,class:"flex gap-2"},Te={style:{right:"1rem"},class:"absolute pi pi-bolt text-main-color"},ye=["src"],Ce={class:"flex h-full flex-column gap-2"},ke={class:"text-custom-mini text-700"},De={__name:"ToolCard",props:{value:{type:Object,required:!1,default:()=>{}},role:{type:String,required:!1,default:"USER"},isCreate:{type:Boolean,required:!1,default:!1}},emits:["onCreate","onUpdate","onDelete"],setup(l,{emit:f}){const x=l,{onActionPlusAmountTool:D,onActionCheckProTool:$}=w(),d=Z(),T=P(),s=C(()=>x.value),S=async(_,o)=>{if(!se.value){d.info("Vui lòng đăng nhập để thực hiện tính năng này!");return}if(!(await $(_)).success)return;T.getRoutes().map(({name:i})=>i).includes(o)?D(_).then(i=>{i.success&&T.push({name:o,params:{id:x.value._id}})}):d.info("Tính năng chưa phát triển!")};return(_,o)=>{var a,p,i,g;return u(),m("div",ve,[l.role==="ADMIN"?(u(),m("div",he,[t("i",{style:{"background-color":"#059669"},class:"pi pi-pencil on-click p-3 border-circle",onClick:o[0]||(o[0]=v=>{var n;return f("onUpdate",(n=s.value)==null?void 0:n._id)})}),t("i",{style:{"background-color":"#dc2626"},class:"pi pi-delete-left on-click p-3 border-circle",onClick:o[1]||(o[1]=v=>{var n;return f("onDelete",(n=s.value)==null?void 0:n._id)})})])):F("",!0),l.isCreate?(u(),m("div",be,[t("i",{class:"pi pi-plus text-2xl text-600 border-1 p-2 on-click border-circle",onClick:o[2]||(o[2]=v=>f("onCreate"))})])):(u(),m("div",xe,[ee(t("i",Te,null,512),[[te,(a=s.value)==null?void 0:a.isProTool]]),t("img",{style:{"border-left":"3px solid #4caf50","object-fit":"contain"},class:"w-5rem h-5rem",src:(p=s.value)==null?void 0:p.image,alt:"Lỗi ảnh"},null,8,ye),t("div",Ce,[t("span",{class:"line-height-2 on-click text-800 fixed-text",onClick:o[3]||(o[3]=v=>{var n,h;return S((n=s.value)==null?void 0:n._id,(h=s.value)==null?void 0:h.routeName)})},U((i=s.value)==null?void 0:i.title),1),t("span",ke," Đã có "+U(k(oe)((g=s.value)==null?void 0:g.amount))+" lượt sử dụng ",1)])]))])}}},j=I(De,[["__scopeId","data-v-6f02da80"]]);const $e=l=>(pe("data-v-7ed8a0dd"),l=l(),me(),l),Se={class:"flex gap-2"},Ae={class:"w-full flex flex-column gap-1"},Oe={class:"flex gap-2 align-items-center mt-2"},Re=$e(()=>t("span",null,"Áp dụng trả phí",-1)),Ue={class:"flex flex-column gap-4"},qe={style:{gap:"2%"},class:"card-container flex flex-wrap"},Be={__name:"Tool",setup(l){const f=ne(),x=P(),{onGetterListTool:D,onGetterToolDetail:$,onActionGetListTool:d,onActionGetToolDetail:T,onActiveSaveTool:s,onActionDeleteTool:S}=w(),_=C(()=>D.value),o=ae({image:null,title:"",routeName:"",isProTool:!1}),a=q(!1),p=q("Thêm ứng dụng"),i=C(()=>x.options.routes.find(({name:e})=>e==="App").children.find(({name:e})=>e==="ToolDetail").children.filter(e=>e.path.split("/").length===2).map(e=>({name:e.path,code:e.name}))),g=C(()=>le.value.role),v=O({image:O().required("Vui lòng chọn ảnh"),title:R().required("Vui lòng nhập tên ứng dụng"),routeName:R().required("Vui lòng nhập đường dẫn")}),{values:n,resetForm:h,setFieldValue:L,handleSubmit:E}=W({validationSchema:v,keepValuesOnUnmount:!0}),{value:A}=Y("isProTool"),G=async e=>{(await T(e)).success&&(p.value="Cập nhật ứng dụng",a.value=!0)},M=async e=>{f.require({message:"Bạn có chắc xóa ứng dụng này?",header:"Xác nhận",acceptLabel:"Đồng ý",acceptClass:"p-button-danger",rejectLabel:"Hủy bỏ",rejectClass:"p-button-outlined",accept:async()=>{(await S(e)).success&&d(!0)}})},z=E(async()=>{(await s(n)).success&&(a.value=!1,d(!0))});return ie($,e=>{h({values:Object.assign(o,e)}),e.image&&L("image",{name:e==null?void 0:e.image.split("$")[1],base64:e==null?void 0:e.image})}),ce(()=>{d()}),(e,c)=>{const H=y("Checkbox"),J=y("Button"),V=y("Dialog"),X=y("ConfirmDialog");return u(),m(N,null,[r(V,{visible:a.value,"onUpdate:visible":c[1]||(c[1]=b=>a.value=b),modal:"",header:p.value,class:"w-25rem"},{default:re(()=>[t("div",Se,[r(_e,{name:"image",class:"image w-8rem h-8rem"}),t("div",Ae,[r(Q,{name:"title",class:"w-full",placeholder:"Tên ứng dụng"}),r(ge,{name:"routeName",options:i.value,placeholder:"Tên đường dẫn",required:!1},null,8,["options"]),t("div",Oe,[r(H,{modelValue:k(A),"onUpdate:modelValue":c[0]||(c[0]=b=>de(A)?A.value=b:null),binary:!0},null,8,["modelValue"]),Re])])]),r(J,{label:"Thêm ứng dụng",class:"w-full mt-5",onClick:k(z)},null,8,["onClick"])]),_:1},8,["visible","header"]),t("div",Ue,[r(fe,{icon:"pi pi-microsoft",title:"Ứng dụng"}),t("div",qe,[g.value==="ADMIN"?(u(),B(j,{key:0,onOnCreate:c[2]||(c[2]=()=>{a.value=!0,k(h)({values:{}})}),isCreate:!0})):F("",!0),(u(!0),m(N,null,ue(_.value,(b,K)=>(u(),B(j,{key:K,value:b,role:g.value,onOnUpdate:G,onOnDelete:M},null,8,["value","role"]))),128))])]),r(X)],64)}}},Le=I(Be,[["__scopeId","data-v-7ed8a0dd"]]);export{Le as default};
