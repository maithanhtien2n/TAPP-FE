import{B as z,c as B,o as l,d as r,t as y,v,e as s,x as p,N as d,g as o,R as D,s as c,f as C,P as N}from"./index-cd90e316.js";import{a as j}from"./vee-validate.esm-7e106f6b.js";const R={class:"p-error"},F={class:"flex flex-column gap-1"},L={key:0,class:"pi pi-plus"},U={key:1,class:"flex flex-column gap-1 align-items-center"},V=s("i",{class:"pi pi-camera text-2xl"},null,-1),M=["accept","onDrop"],T={class:"flex flex-column gap-1"},E=s("span",null,"Đang tải...",-1),G=["src"],$={key:1,class:"w-full h-full",controls:""},J=["src"],O={key:2,class:"w-full h-full flex align-items-center justify-content-center"},A={class:"flex flex-column"},I=s("img",{class:"w-10rem h-10rem object-fit-cover",src:"https://cdn1.iconfinder.com/data/icons/fs-icons-ubuntu-by-franksouza-/512/application-x-rar.png",alt:"Lỗi ảnh"},null,-1),W={class:"p-error"},X={__name:"ImageValidate",props:{name:{type:String,required:!0,default:""},label:{type:String,required:!1,default:""},class:{type:String,required:!1,default:"w-12rem h-12rem"},style:{type:Object,required:!1,default:()=>{}},disabled:{type:Boolean,required:!1,default:!1},miniSize:{type:Boolean,required:!1,default:!1},required:{type:Boolean,required:!1,default:!0},imageProps:{type:Object,required:!1,default:()=>({maxSize:100,accept:"image/*",type:"JPG,JPEG,PNG"})}},emits:["onUpload","onRemove"],setup(b,{emit:f}){const e=b,{value:i,errorMessage:x,setErrors:m,setValue:g}=j(e.name),u=z(!1),k=t=>{const a=t/1048576;return Number(a%1===0?a.toFixed(0):a.toFixed(2))},P=t=>{var a,n;if(k(t.target.files[0].size)>Number((a=e==null?void 0:e.imageProps)==null?void 0:a.maxSize))return m(`Dung lượng tệp không được vượt quá ${(n=e==null?void 0:e.imageProps)==null?void 0:n.maxSize}MB`),!0;if(!e.imageProps.type.toLowerCase().split(",").includes(t.target.files[0].name.split(".")[t.target.files[0].name.split(".").length-1].toLowerCase()))return m("Tệp không đúng định dạng"),!0},h=async t=>{if(P(t))return;u.value=!0;const a=new FileReader;a.readAsDataURL(t.target.files[0]),a.onload=n=>{n.target.result&&g({name:t.target.files[0].name,base64:n.target.result}),u.value=!1},f("onUpload",t)},w=async t=>{const a={target:{files:[t.dataTransfer.files[0]]}};t.preventDefault(),h(a)},S=t=>{switch(t){case"image/*":return"ảnh";case"video/*":return"video";default:return"file"}},q=t=>{g(null),f("onRemove",t)};return(t,a)=>{var _;const n=B("ProgressSpinner");return l(),r("div",{class:d(["flex flex-column gap-2",e.class])},[y(s("label",null,[s("span",null,p(e.label),1),y(s("span",R,"*",512),[[v,e.required]])],512),[[v,e.label]]),s("div",F,[s("div",{class:d([{"p-disabled":e.disabled},"border-1 border-dashed text-main-color border-round-lg overflow-hidden"])},[!o(i)&&!u.value?(l(),r("div",{key:0,class:d([e.class,"relative flex align-items-center justify-content-center"])},[e.miniSize?(l(),r("i",L)):(l(),r("div",U,[V,s("span",null,p(`Thêm ${S(e.imageProps.accept)}`),1)])),s("input",{type:"file",class:"absolute top-0 right-0 left-0 bottom-0 opacity-0 on-click",accept:e.imageProps.accept,onDrop:D(w,["prevent"]),onChange:h},null,40,M)],2)):c("",!0),u.value&&!o(i)?(l(),r("div",{key:1,class:d([e.class,"relative flex justify-content-center align-items-center"])},[s("div",T,[C(n,{style:{width:"40px",height:"40px"},strokeWidth:"3",animationDuration:".5s"}),E])],2)):c("",!0),o(i)&&!u.value?(l(),r("div",{key:2,class:d([e.class,"relative"]),style:N(e.style)},[s("i",{style:{"background-color":"rgba(240, 248, 255, 0.767)"},class:"pi pi-times absolute right-0 p-1 border-round-lg on-click z-5",onClick:a[0]||(a[0]=H=>q(o(i)))}),e.imageProps.accept==="image/*"?(l(),r("img",{key:0,style:{"object-fit":"contain"},class:"w-full h-full",src:o(i).base64,alt:"Lỗi ảnh"},null,8,G)):c("",!0),e.imageProps.accept==="video/*"?(l(),r("video",$,[s("source",{src:o(i).base64,type:"video/mp4"},null,8,J)])):c("",!0),e.imageProps.accept===".rar"?(l(),r("div",O,[s("div",A,[I,s("span",null,p((_=o(i))==null?void 0:_.name),1)])])):c("",!0)],6)):c("",!0)],2),s("small",W,p(o(x)),1)])],2)}}};export{X as _};
